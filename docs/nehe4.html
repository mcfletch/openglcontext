<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="content-type"
 content="text/html; charset=ISO-8859-1">
  <title>NeHe4 for OpenGLContext</title>
  <link rel="stylesheet" type="text/css" href="style/tutorial.css">
  <meta name="author" content="Mike C. Fletcher">
</head>
<body>
<h1>NeHe4 for OpenGLContext</h1>
<p class="introduction">This&nbsp;document discusses the <a
 href="http://nehe.gamedev.net/tutorials/lesson.asp?l=04">NeHe4 tutorial</a>
by Jeff Molofee. It adds simple glRotate-based rotation to the polygons
defined in NeHe3. &nbsp;It also demonstrates the OpenGLContext OnIdle
handler.</p>
<p>See <a href="nehe3.html">NeHe3</a> for discussion of the Context
setup procedure here...<br>
</p>
<pre>from OpenGLContext import testingcontext<br>BaseContext, MainFunction = testingcontext.getInteractive()<br>from OpenGL.GL import *<br></pre>
<p>We import the time module as well to provide crude animation
support, then go back to the previously-seen code.<br>
</p>
<pre>import time<br><br>class TestContext( BaseContext ):<br>	# set initial camera position, tutorial does the re-positioning<br>	initialPosition = (0,0,0)<br>	def Render( self, mode = 0):<br>		"""Render the geometry for the scene."""<br>		BaseContext.Render( self, mode )<br>		glDisable( GL_CULL_FACE )<br>		glDisable( GL_LIGHTING)<br>		glTranslatef(-1.5,0.0,-6.0);<br></pre>
<p>Now we do the rotation. &nbsp;We use time.time() with some mucking
about to get a nice angular rotation which cycles once every 3 seconds,
then use that to rotate about the y axis (0,1,0).<br>
</p>
<pre>		glRotated( time.time()%(3.0)/3 * 360, 0,1,0)<br></pre>
<p>The rest of the Render function is taken from the original NeHe
tutorial.<br>
</p>
<pre>		glBegin(GL_TRIANGLES)<br>		glColor3f(1,0,0)<br>		glVertex3f( 0.0,  1.0, 0.0)<br>		glColor3f(0,1,0)<br>		glVertex3f(-1.0, -1.0, 0.0)<br>		glColor3f(0,0,1)<br>		glVertex3f( 1.0, -1.0, 0.0)<br>		glEnd()<br></pre>
<p>glLoadIdentity resets the model-view matrix to the identity matrix,
eliminating the effects of the previous rotation.</p>
<p class="technical">Normally you would use glPushMatrix/glPopMatrix to
prevent messing up higher-level abstractions, but that's not an issue
for these stand-alone tutorials.</p>
<pre>		glLoadIdentity()<br>		glTranslatef(1.5,0.0,-6.0);<br></pre>
<p>Same basic approach as above, save that we use 1 rps instead of 3.<br>
</p>
<pre>		glRotated( time.time()%(1.0)/1 * -360, 1,0,0)<br><br>		glColor3f(0.5,0.5,1.0)<br>		glBegin(GL_QUADS)<br>		glVertex3f(-1.0,-1.0, 0.0)<br>		glVertex3f( 1.0,-1.0, 0.0)<br>		glVertex3f( 1.0, 1.0, 0.0)<br>		glVertex3f(-1.0, 1.0, 0.0)<br>		glEnd()<br></pre>
<p>Another of OpenGLContext's Context customisation points is the
OnIdle method. &nbsp;If present, it is called when the Context becomes
idle (no pending redraw events). &nbsp;In this case, we just tell the
context to redraw itself whenever the OnIdle handler is called.<br>
</p>
<p class="technical">This is not how you would normally want an
animation to run, as it will suck up 100% of your CPU's power just for
the animation. &nbsp;For the stand-alone test, however, it doesn't
really bother us to do so.<br>
</p>
<pre>	def OnIdle( self, ):<br>		"""Request refresh of the context whenever idle"""<br>		self.triggerRedraw(1)<br>		return 1<br></pre>
<p>And finally, we make the script run MainFunction with an instance of
our TestContext if the module is run as a script.<br>
</p>
<pre>if __name__ == "__main__":<br>	## We only want to run the main function if we<br>	## are actually being executed as a script<br>	MainFunction ( TestContext)<br></pre>
<p>You can find the complete code for this sample in
OpenGLContext/tests/nehe4.py<br>
</p>
<p class="footer"><a href="documentation.html"><img
 src="images/doc_icon.gif" title="" alt="Documentation"
 style="border: 0px solid ; width: 32px; height: 32px;" align="middle"></a> <a
 href="http://pyopengl.sourceforge.net/context/"><img
 src="images/context_logo_icon.png" title="" alt="OpenGLContext"
 style="border: 0px solid ; width: 32px; height: 32px;" align="middle"></a> <a
 href="http://pyopengl.sourceforge.net/"><img align="middle" title=""
 alt="PyOpenGL" src="images/pyopengl_icon.jpg"
 style="border: 0px solid ; width: 32px; height: 32px;"></a> A
SourceForge Open-Source project: <a href="http://sourceforge.net"><img
 src="http://sourceforge.net/sflogo.php?group_id=5988&amp;type=1"
 style="border: 0px solid ; width: 88px; height: 31px;"
 alt="SourceForge" title="" align="middle"></a></p>
</body>
</html>
